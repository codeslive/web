<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>fetch</title>
</head>

<body>
  <button id="btn">发送</button>
  <img src="https://mibook.codeslive.top/api/public/showImg/db0d38857ca74659a54734b1602855e9" alt="01">
  <div><span id="text"></span></div>
  <script>
    const btn = document.querySelector('#btn');
    btn.addEventListener('click', () => {
      sendFetch()
    });

    const text = document.querySelector('#text');

    async function sendFetch() {
      // 第一个参数 url 默认请求方式 get 返回值是一个 promise 对象
      const res = await fetch('/api/cfg/kefu?_timespan=1687167914768');
      console.log(res);
    }

    // const sendFetch = (async) => {
    //   // 第一个参数 url 默认请求方式 get 返回值是一个 promise 对象
    //   // fetch('/api/cfg/kefu?_timespan=1687167914768').then(res => {
    //   //   console.log(res);
    //   //   // 设置一个进度条
    //   //   const total = res.headers.get('content-length');
    //   //   let loaded = 0;
    //   //   const progress = document.createElement('progress');
    //   //   progress.max = total;
    //   //   document.body.appendChild(progress);
    //   //   // 监听数据传输
    //   //   const reader = res.body.getReader();
    //   //   reader.read().then(function processResult (result) {
    //   //     if (result.done) {
    //   //       console.log('Fetch complete');
    //   //       return;
    //   //     }
    //   //     loaded += result.value.length;
    //   //     console.log(`Received ${loaded} of ${total}`);
    //   //     progress.value = loaded;
    //   //     // Read some more, and call this function again
    //   //     // return reader.read().then(processResult);
    //   //   });

    //   //   return res.json();


    //   // }).then(data => {
    //   //   console.log(data.data)
    //   // })


    //   fetch('/api/cfg/kefu?_timespan=1687167914768').then(res => {
    //     console.log(res);
        
    //   }).then(data => {
    //     // console.log(data)
    //   })

    // }
  </script>
</body>

</html>